<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://www.gstatic.com/firebasejs/9.4.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.4.0/firebase-database.js"></script>
  <title>Random Word Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 50px;
    }

    table {
      width: 80%;
      margin: 20px auto;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    .used {
      text-decoration: line-through;
      color: #999;
    }

    .hidden {
      display: none;
    }

    #definition {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<h1>Random Word Generator</h1>
<input type="radio" name="category" value="primary" id="primaryRadio" checked onclick="updateCategory()"> 
  <label for="primaryRadio">Primary</label>
<input type="radio" name="category" value="intermediate" id="intermediateRadio" onclick="updateCategory()"> 
  <label for="intermediateRadio">Intermediate</label>

<button onclick="generateRandomWord()">Generate Random Word</button>
<button onclick="resetUsedWords()">Reset Used Words</button>
<p id="randomWord" onclick="showDefinition()"></p>
<div id="definition" class="hidden">
  <h3>Definitions</h3>
  <table id="wordDefinitions"></table>
  <h3>Examples</h3>
  <table id="wordExamples"></table>
</div>

<h2>Word Lists</h2>
<p id="numWordsLeft">Words Left: 0</p>
<p id="totalNumWords">Total Words: 0</p>
<table id="primaryTable" class="hidden">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="primaryList"></tbody>
</table>

<table id="intermediateTable" class="hidden">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="intermediateList"></tbody>
</table>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAjBQR3CIyFe2B3X764vUAlgZBBv6MXWxU",
  authDomain: "spelling-f0a67.firebaseapp.com",
  projectId: "spelling-f0a67",
  storageBucket: "spelling-f0a67.appspot.com",
  messagingSenderId: "417568436363",
  appId: "1:417568436363:web:f2815fd681ccfaf640a48e",
  measurementId: "G-82924CD1JX"
};


  // Initialize Firebase
  const firebaseApp = firebase.initializeApp(firebaseConfig);
  const db = firebaseApp.database();

  const primaryWords = ["again", "although", "answer", "any", "are", "become", "been", "both", "bought", "catch",
                        "climbed", "color", "come", "could", "country", "do", "does", "door", "earth", "edge",
                        "eight", "enough", "example", "eyes", "father", "few", "find", "four", "friend", "from",
                        "give", "great", "group", "have", "heard", "island", "kind", "knew", "know", "learn", "listen",
                        "live", "many", "measure", "most", "mother", "move", "night", "off", "often", "old", "on",
                        "once", "one", "only", "other", "people", "picture", "piece", "quickly", "right", "said",
                        "science", "should", "sign", "snow", "some", "straight", "stretch", "sure", "talk", "their",
                        "there", "they", "though", "thought", "through", "to", "today", "two", "usually", "walk",
                        "want", "was", "watch", "water", "were", "what", "where", "who", "women", "word", "work",
                        "world", "would", "write", "wrote", "you", "young", "your"];

  const intermediateWords = ["ineffectual", "philosophy", "resurgence", "phenomena", "simultaneous", "temporarily",
                             "vocabulary", "ploughman", "yacht", "empirical", "deficient", "charismatic",
                             "alias", "borough", "circumstance", "ethos", "inheritance", "monarchy",
                             "consequence", "archives", "conquered", "obsolete", "tolerance", "electronically",
                             "dialect", "neutron", "initially", "archaic", "inspiration", "contemporary"];

  let selectedCategory = "primary";
  const usedWords = { primary: [], intermediate: [] };

  function generateRandomWord() {
    const currentCategory = selectedCategory === "primary" ? primaryWords : intermediateWords;

    if (usedWords[selectedCategory].length === currentCategory.length) {
      document.getElementById("randomWord").innerHTML = "<h1>All words have been used!</h1>";
      return;
    }

    const remainingWords = currentCategory.filter(word => !usedWords[selectedCategory].includes(word));
    const randomIndex = Math.floor(Math.random() * remainingWords.length);
    const randomWord = remainingWords[randomIndex];

    usedWords[selectedCategory].push(randomWord);

    const db = firebase.database();
    db.ref(`${selectedCategory}/usedWords`).set(usedWords[selectedCategory]);

    document.getElementById("randomWord").innerHTML = `<h1>${randomWord}</h1>`;

    document.getElementById("definition").classList.add("hidden");
    updateWordList();
  }

  function resetUsedWords() {
    usedWords.primary = [];
    usedWords.intermediate = [];

    const db = firebase.database();
    db.ref("primary/usedWords").set([]);
    db.ref("intermediate/usedWords").set([]);

    updateWordList();
  }

  function updateWordList() {
    const primaryTable = document.getElementById("primaryTable");
    const intermediateTable = document.getElementById("intermediateTable");

    const primaryListContainer = document.getElementById("primaryList");
    const intermediateListContainer = document.getElementById("intermediateList");

    primaryTable.classList.toggle("hidden", selectedCategory !== "primary");
    intermediateTable.classList.toggle("hidden", selectedCategory !== "intermediate");

    primaryListContainer.innerHTML = "";
    intermediateListContainer.innerHTML = "";

    const currentWords = selectedCategory === "primary" ? primaryWords : intermediateWords;
    const words = currentWords.sort();
    const numColumns = 5;
    const numRows = Math.ceil(words.length / numColumns);

    for (let row = 0; row < numRows; row++) {
      const tr = document.createElement("tr");

      for (let col = 0; col < numColumns; col++) {
        const index = row * numColumns + col;
        if (index < words.length) {
          const word = words[index];
          const td = document.createElement("td");

          if (usedWords[selectedCategory].includes(word)) {
            td.innerHTML = `<span class="used">${word}</span>`;
          } else {
            td.textContent = word;
          }

          tr.appendChild(td);
        }
      }

      if (selectedCategory === "primary") {
        primaryListContainer.appendChild(tr);
      } else {
        intermediateListContainer.appendChild(tr);
      }
    }

    updateWordCount();
  }

  function updateWordCount() {
    const numWordsLeft = primaryWords.length - usedWords.primary.length;
    const totalNumWords = primaryWords.length;

    document.getElementById("numWordsLeft").textContent = `Words Left: ${numWordsLeft}`;
    document.getElementById("totalNumWords").textContent = `Total Words: ${totalNumWords}`;
  }

  function updateCategory() {
    selectedCategory = document.querySelector('input[name="category"]:checked').value;
    updateWordList();
  }

  function showDefinition() {
    const randomWord = document.getElementById("randomWord").textContent;

    fetch(`https://wordsapiv1.p.rapidapi.com/words/${randomWord}`, {
      method: "GET",
      headers: {
        "X-RapidAPI-Host": "wordsapiv1.p.rapidapi.com",
        "X-RapidAPI-Key": "06f20456cfmsh1b8e00ea9fb360dp1243b0jsn77475ae1802e"
      }
    })
    .then(response => response.json())
    .then(data => {
      if (data && data.results && data.results.length > 0) {
        const definitions = data.results.map(result => result.definition).filter(Boolean);
        const examples = data.results.map(result => result.examples).flat().filter(Boolean);

        showDefinitionAndExamples(definitions, examples);
      } else {
        document.getElementById("definition").classList.remove("hidden");
        document.getElementById("wordDefinitions").innerHTML = "<tr><td>No definitions available.</td></tr>";
        document.getElementById("wordExamples").innerHTML = "<tr><td>No examples available.</td></tr>";
      }
    })
    .catch(error => {
      console.error("Error fetching data from WordsAPI:", error);
    });
  }

  function showDefinitionAndExamples(definitions, examples) {
    const wordDefinitionsContainer = document.getElementById("wordDefinitions");
    const wordExamplesContainer = document.getElementById("wordExamples");

    wordDefinitionsContainer.innerHTML = "";
    wordExamplesContainer.innerHTML = "";

    for (const definition of definitions) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.textContent = definition;
      tr.appendChild(td);
      wordDefinitionsContainer.appendChild(tr);
    }

    for (const example of examples.slice(0, 5)) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.textContent = example;
      tr.appendChild(td);
      wordExamplesContainer.appendChild(tr);
    }

    document.getElementById("definition").classList.remove("hidden");
  }

  // Subscribe to changes in the Firebase database on page load
  const db = firebase.database();

  db.ref("primary/usedWords").on('value', snapshot => {
    const usedWordsFromFirebase = snapshot.val();
    if (usedWordsFromFirebase) {
      usedWords.primary = usedWordsFromFirebase;
    }
    updateWordList();
  });

  db.ref("intermediate/usedWords").on('value', snapshot => {
    const usedWordsFromFirebase = snapshot.val();
    if (usedWordsFromFirebase) {
      usedWords.intermediate = usedWordsFromFirebase;
    }
    updateWordList();
  });

  // Initial update of the word list
  updateWordList();
</script>

</body>
</html>
