<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Random Word Selector</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 50px;
    }

    table {
      width: 80%;
      margin: 20px auto;
      border-collapse: collapse;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }

    th {
      background-color: #f2f2f2;
    }

    .used {
      text-decoration: line-through;
      color: #999;
    }

    .hidden {
      display: none;
    }

    #definition {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<h1>Random Word Selector</h1>

<input type="radio" name="levelType" value="primary" id="primaryRadio" checked onclick="updateLevelType()">
  <label for="primaryRadio">Primary</label>
<input type="radio" name="levelType" value="intermediate" id="intermediateRadio" onclick="updateLevelType()">
  <label for="intermediateRadio">Intermediate</label>

<input type="radio" name="level" value="level1" id="level1Radio" checked onclick="updateLevel()"> 
  <label for="level1Radio">Level 1</label>
<input type="radio" name="level" value="level2" id="level2Radio" onclick="updateLevel()"> 
  <label for="level2Radio">Level 2</label>
<input type="radio" name="level" value="level3" id="level3Radio" onclick="updateLevel()"> 
  <label for="level3Radio">Level 3</label>
<input type="radio" name="level" value="level4" id="level4Radio" onclick="updateLevel()"> 
  <label for="level4Radio">Level 4</label>
<input type="radio" name="level" value="level5" id="level5Radio" onclick="updateLevel()"> 
  <label for="level5Radio">Level 5</label>
<input type="radio" name="level" value="extraWords" id="extraWordsRadio" onclick="updateLevel()"> 
  <label for="extraWordsRadio">Extra Words</label>

<button onclick="generateRandomWord()">Generate Random Word</button>
<button onclick="resetUsedWords()">Reset Used Words</button>
<p id="randomWord" onclick="showDefinition()"></p>
<div id="definition" class="hidden">
  <h3>Definitions</h3>
  <table id="wordDefinitions"></table>
  <h3>Examples</h3>
  <table id="wordExamples"></table>
</div>

<h2>Word Lists</h2>
<p id="numWordsLeft">Words Left: 0</p>
<p id="totalNumWords">Total Words: 0</p>

<table id="level1Table" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="level1List"></tbody>
</table>

<!-- Add similar tables for other levels (level2Table, level3Table, etc.) -->
<table id="level2Table" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="level2List"></tbody>
</table>

<table id="level3Table" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="level3List"></tbody>
</table>

<table id="level4Table" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="level4List"></tbody>
</table>

<table id="level5Table" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="level5List"></tbody>
</table>

<table id="extraWordsTable" class="word-list-container">
  <thead>
    <tr>
      <th>Column 1</th>
      <th>Column 2</th>
      <th>Column 3</th>
      <th>Column 4</th>
      <th>Column 5</th>
    </tr>
  </thead>
  <tbody id="extraWordsList"></tbody>
</table>
<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.4.0/firebase-app.js';
  import { getDatabase, ref, set, onValue } from 'https://www.gstatic.com/firebasejs/9.4.0/firebase-database.js';
  
  window.generateRandomWord = generateRandomWord;
  window.resetUsedWords = resetUsedWords;
  window.updateLevel = updateLevel;
  window.showDefinition = showDefinition;


const firebaseConfig = {
  apiKey: "AIzaSyAjBQR3CIyFe2B3X764vUAlgZBBv6MXWxU",
  authDomain: "spelling-f0a67.firebaseapp.com",
  databaseURL: "https://spelling-f0a67-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "spelling-f0a67",
  storageBucket: "spelling-f0a67.appspot.com",
  messagingSenderId: "417568436363",
  appId: "1:417568436363:web:f2815fd681ccfaf640a48e",
  measurementId: "G-82924CD1JX"
};

  // Initialize Firebase
  const firebaseApp = initializeApp(firebaseConfig);
  const db = getDatabase(firebaseApp);

const level1Words = [
  "apple", "banana", "cherry", "dog", "elephant",
  "flower", "guitar", "happy", "igloo", "jazz",
  "kite", "lemon", "mountain", "notebook", "orange",
  "puzzle", "rainbow", "sun", "tiger", "umbrella"
];

const level2Words = [
  "bicycle", "cactus", "diamond", "eagle", "fountain",
  "giraffe", "happiness", "ice cream", "jungle", "kiwi",
  "lighthouse", "magnificent", "ocean", "parrot", "quilt",
  "rocket", "sunset", "treasure", "volcano", "waterfall"
];

const level3Words = [
  "astronomy", "breathtaking", "caterpillar", "dolphin", "elegant",
  "fantastic", "gargantuan", "harmony", "illuminate", "jubilant",
  "kaleidoscope", "luminous", "mysterious", "nostalgia", "orchestra",
  "phenomenal", "quintessential", "serendipity", "tranquil", "universal"
];

const level4Words = [
  "ambassador", "benevolent", "cynosure", "effervescent", "fortuitous",
  "gallant", "hierarchical", "indomitable", "juxtapose", "kaleidoscopic",
  "labyrinthine", "mellifluous", "nepotism", "obfuscate", "philanthropy",
  "quizzical", "resplendent", "superfluous", "ubiquitous", "verisimilitude"
];

const level5Words = [
  "acquiesce", "belligerent", "cacophony", "deleterious", "ephemeral",
  "facetious", "gregarious", "hirsute", "iconoclast", "juxtaposition",
  "kowtow", "lugubrious", "mellifluous", "nonchalant", "obfuscate",
  "paradigm", "quixotic", "recalcitrant", "sycophant", "ubiquitous"
];

const extraWords = [
  "effulgent", "bibliopole", "susurrus", "gallimaufry", "discombobulate",
  "limerence", "recumbentibus", "sesquipedalian", "vicissitude", "mellisonant",
  "perfidious", "quidnunc", "soliloquy", "verisimilitude", "xenodochial",
  "zydeco", "prestidigitation", "sesquipedalian", "uliginous", "zyzzyva"
];


const ilevel1Words = [
  "apple", "banana", "cherry", "dog", "elephant",
  "flower", "guitar", "happy", "igloo", "jazz",
  "kite", "lemon", "mountain", "notebook", "orange",
  "puzzle", "rainbow", "sun", "tiger", "umbrella"
];

const ilevel2Words = [
  "bicycle", "cactus", "diamond", "eagle", "fountain",
  "giraffe", "happiness", "ice cream", "jungle", "kiwi",
  "lighthouse", "magnificent", "ocean", "parrot", "quilt",
  "rocket", "sunset", "treasure", "volcano", "waterfall"
];

const ilevel3Words = [
  "astronomy", "breathtaking", "caterpillar", "dolphin", "elegant",
  "fantastic", "gargantuan", "harmony", "illuminate", "jubilant",
  "kaleidoscope", "luminous", "mysterious", "nostalgia", "orchestra",
  "phenomenal", "quintessential", "serendipity", "tranquil", "universal"
];

const ilevel4Words = [
  "ambassador", "benevolent", "cynosure", "effervescent", "fortuitous",
  "gallant", "hierarchical", "indomitable", "juxtapose", "kaleidoscopic",
  "labyrinthine", "mellifluous", "nepotism", "obfuscate", "philanthropy",
  "quizzical", "resplendent", "superfluous", "ubiquitous", "verisimilitude"
];

const ilevel5Words = [
  "acquiesce", "belligerent", "cacophony", "deleterious", "ephemeral",
  "facetious", "gregarious", "hirsute", "iconoclast", "juxtaposition",
  "kowtow", "lugubrious", "mellifluous", "nonchalant", "obfuscate",
  "paradigm", "quixotic", "recalcitrant", "sycophant", "ubiquitous"
];

const iextraWords = [
  "effulgent", "bibliopole", "susurrus", "gallimaufry", "discombobulate",
  "limerence", "recumbentibus", "sesquipedalian", "vicissitude", "mellisonant",
  "perfidious", "quidnunc", "soliloquy", "verisimilitude", "xenodochial",
  "zydeco", "prestidigitation", "sesquipedalian", "uliginous", "zyzzyva"
];

  window.level1Words = level1Words;
window.level2Words = level2Words;
window.level3Words = level3Words;
window.level4Words = level4Words;
window.level5Words = level5Words;
window.extraWords = extraWords;


  window.ilevel1Words = ilevel1Words;
window.ilevel2Words = ilevel2Words;
window.ilevel3Words = ilevel3Words;
window.ilevel4Words = ilevel4Words;
window.ilevel5Words = ilevel5Words;
window.iextraWords = iextraWords;

 let selectedLevelType = "primary";
  let selectedLevel = "level1";
const usedWords = { 
    primary: { level1: [], level2: [], level3: [], level4: [], level5: [], extraWords: [] }, 
    intermediate: { level1: [], level2: [], level3: [], level4: [], level5: [], extraWords: [] } 
  };


function generateRandomWord() {
    const currentWords = getWordsForLevel(selectedLevelType, selectedLevel);


    if (!currentWords || usedWords[selectedLevelType][selectedLevel].length === currentWords.length) {
        document.getElementById("randomWord").innerHTML = "<h1>All words have been used!</h1>";
        return;
    }

    const remainingWords = currentWords.filter(word => !usedWords[selectedLevelType][selectedLevel].includes(word));

    if (remainingWords.length === 0) {
        // All words have been used after filtering, update UI accordingly
        document.getElementById("randomWord").innerHTML = "<h1>All words have been used!</h1>";
        return;
    }

    const randomIndex = Math.floor(Math.random() * remainingWords.length);
    const randomWord = remainingWords[randomIndex];

    usedWords[selectedLevelType][selectedLevel].push(randomWord);

    // Simplified Firebase Realtime Database update
    set(ref(db, `${selectedLevelType}/${selectedLevel}/usedWords`), usedWords[selectedLevelType][selectedLevel].slice());


    document.getElementById("randomWord").innerHTML = `<h1>${randomWord}</h1>`;

    document.getElementById("definition").classList.add("hidden");
    updateWordList();
}


function resetUsedWords() {
    usedWords[selectedLevelType][selectedLevel] = [];

    // Simplified Firebase Realtime Database update
    set(ref(db, `${selectedLevelType}/${selectedLevel}/usedWords`), []);

    updateWordList();
}

function updateWordList() {
    const currentTable = getTableForLevel(selectedLevel);
    const currentListContainer = getListContainerForLevel(selectedLevel);

    if (!currentTable || !currentListContainer) {
        console.error("Table, list container, or words for the selected level are not defined.");
        return;
    }

    // Hide all tables
    document.querySelectorAll('table[id^="level"]').forEach(table => {
        table.classList.add("hidden");
    });

       document.querySelectorAll('table[id^="extraWords"]').forEach(table => {
        table.classList.add("hidden");
    });

    currentTable.classList.remove("hidden");
    currentListContainer.innerHTML = "";

    const currentWords = getWordsForLevel(selectedLevelType, selectedLevel);

    if (!currentWords) {
        console.error("Words for the selected level are not defined.");
        return;
    }

    const words = currentWords.sort();
    const numColumns = 5;
    const numRows = Math.ceil(words.length / numColumns);

    for (let row = 0; row < numRows; row++) {
        const tr = document.createElement("tr");

        for (let col = 0; col < numColumns; col++) {
            const index = row * numColumns + col;
            if (index < words.length) {
                const word = words[index];
                const td = document.createElement("td");

                if (usedWords[selectedLevelType][selectedLevel].includes(word)) {
                    td.innerHTML = `<span class="used">${word}</span>`;
                } else {
                    td.textContent = word;
                }

                tr.appendChild(td);
            }
        }

        currentListContainer.appendChild(tr);
    }

    updateWordCount();
}





function getWordsForLevel(levelType, level) {
    switch (levelType) {
        case "primary":
            return getPrimaryWordsForLevel(level);
        case "intermediate":
            return getIntermediateWordsForLevel(level);
        default:
            return [];
    }
}

function getPrimaryWordsForLevel(level) {
    switch (level) {
        case "level1":
            return level1Words;
        case "level2":
            return level2Words;
        case "level3":
            return level3Words;
        case "level4":
            return level4Words;
        case "level5":
            return level5Words;
        case "extraWords":
            return extraWords;
        default:
            return [];
    }
}

function getIntermediateWordsForLevel(level) {
    switch (level) {
        case "level1":
            return ilevel1Words;
        case "level2":
            return ilevel2Words;
        case "level3":
            return ilevel3Words;
        case "level4":
            return ilevel4Words;
        case "level5":
            return ilevel5Words;
        case "extraWords":
            return iextraWords;
        default:
            return [];
    }
}

function getTableForLevel(level) {
    switch (level) {
        case "level1":
            return document.getElementById("level1Table");
        case "level2":
            return document.getElementById("level2Table");
        case "level3":
            return document.getElementById("level3Table");
        case "level4":
            return document.getElementById("level4Table");
        case "level5":
            return document.getElementById("level5Table");
        case "extraWords":
            return document.getElementById("extraWordsTable");
        default:
            return null;
    }
}

function getListContainerForLevel(level) {
    switch (level) {
        case "level1":
            return document.getElementById("level1List");
        case "level2":
            return document.getElementById("level2List");
        case "level3":
            return document.getElementById("level3List");
        case "level4":
            return document.getElementById("level4List");
        case "level5":
            return document.getElementById("level5List");
        case "extraWords":
            return document.getElementById("extraWordsList");
        default:
            return null;
    }
}

function updateWordCount() {
    let numWordsLeft, totalNumWords;

    if (selectedLevel === "extraWords") {
        numWordsLeft = window[selectedLevelType][selectedLevel].length - usedWords[selectedLevelType][selectedLevel].length;
        totalNumWords = window[selectedLevelType][selectedLevel].length;
    } else {
        numWordsLeft = window[selectedLevelType][selectedLevel + 'Words'].length - usedWords[selectedLevelType][selectedLevel].length;
        totalNumWords = window[selectedLevelType][selectedLevel + 'Words'].length;
    }

    document.getElementById("numWordsLeft").textContent = `Words Left: ${numWordsLeft}`;
    document.getElementById("totalNumWords").textContent = `Total Words: ${totalNumWords}`;
}
  function updateLevel() {
    selectedLevel = document.querySelector('input[name="level"]:checked').value;
    updateWordList();
  }

  function updateLevelType() {
    selectedLevelType = document.querySelector('input[name="levelType"]:checked').value;
    updateWordList();
}

  function showDefinition() {
    const randomWord = document.getElementById("randomWord").textContent;

    fetch(`https://wordsapiv1.p.rapidapi.com/words/${randomWord}`, {
      method: "GET",
      headers: {
        "X-RapidAPI-Host": "wordsapiv1.p.rapidapi.com",
        "X-RapidAPI-Key": "06f20456cfmsh1b8e00ea9fb360dp1243b0jsn77475ae1802e"
     }
    })
    .then(response => response.json())
    .then(data => {
      if (data && data.results && data.results.length > 0) {
        const definitions = data.results.map(result => result.definition).filter(Boolean);
        const examples = data.results.map(result => result.examples).flat().filter(Boolean);

        showDefinitionAndExamples(definitions, examples);
      } else {
        document.getElementById("definition").classList.remove("hidden");
        document.getElementById("wordDefinitions").innerHTML = "<tr><td>No definitions available.</td></tr>";
        document.getElementById("wordExamples").innerHTML = "<tr><td>No examples available.</td></tr>";
      }
    })
    .catch(error => {
      console.error("Error fetching data from WordsAPI:", error);
    });
  }

  function showDefinitionAndExamples(definitions, examples) {
    const wordDefinitionsContainer = document.getElementById("wordDefinitions");
    const wordExamplesContainer = document.getElementById("wordExamples");

    wordDefinitionsContainer.innerHTML = "";
    wordExamplesContainer.innerHTML = "";

    for (const definition of definitions) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.textContent = definition;
      tr.appendChild(td);
      wordDefinitionsContainer.appendChild(tr);
    }

    for (const example of examples.slice(0, 5)) {
      const tr = document.createElement("tr");
      const td = document.createElement("td");
      td.textContent = example;
      tr.appendChild(td);
      wordExamplesContainer.appendChild(tr);
    }

    document.getElementById("definition").classList.remove("hidden");
  }

  // Subscribe to changes in the Firebase database on page load
for (const levelType in usedWords) {
    for (const level in usedWords[levelType]) {
        onValue(ref(db, `${levelType}/${level}/usedWords`), snapshot => {
            const usedWordsFromFirebase = snapshot.val();
            if (usedWordsFromFirebase) {
                usedWords[levelType][level] = usedWordsFromFirebase;
                if (usedWords[levelType][level].length > 0) {
                    const latestWord = usedWords[levelType][level][usedWords[levelType][level].length - 1];
                    document.getElementById("randomWord").innerHTML = `<h1>${latestWord}</h1>`;
                }
            }
            updateWordList();
        });
    }
}


  // Initial update of the word list
  updateWordList();
</script>

</body>
</html>
